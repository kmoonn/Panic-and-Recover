# 线程

线程是工厂（**进程**）里的工人。

同一个进程里的线程**共享内存和资源**，交流非常方便，几乎是“喊一嗓子就行”。

所以线程比进程**轻得多，切换快**，适合并行干活。

共享意味着风险，一个线程写坏内存，其他线程一起遭殃；再加上锁、竞争、死锁这些情况。

线程是 **CPU 调度的基本单位**，是进程中的执行单元，是独立运行的最小单位，同一进程内的线程**共享进程资源**。

## 资源

- 私有资源
  - 线程栈 Stack
    - 存放局部变量、函数调用信息
  - 程序计数器 PC / 指令指针
    - 记录当前线程执行到哪一条指令
    - 多线程切换必须保存 / 恢复
  - 线程寄存器上下文
    - 通用寄存器、标志寄存器等
    - 用于线程切换
  - 线程 ID
  - 线程状态
- 共享资源（属于进程）
  - 代码段 Text
  - 堆 Heap
  - 全局变量 / 静态变量
  - 打开的文件描述符
  - 信号处理方式
  - 进程地址空间
