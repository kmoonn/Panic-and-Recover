# equals() 和 == 的区别

Java 中 `equals()` 和 `==` 都是用来**比较两个对象**，**比较逻辑完全不同**。

| 特性   | `==`      | `equals()`                    |
|------|-----------|-------------------------------|
| 比较内容 | 引用地址      | 对象的内容（逻辑相等）                   |
| 适用类型 | 基本类型 / 对象 | 对象                            |
| 可重写  | ❌         | ✅ 可以重写（如 String、Integer、List） |
| 默认实现 | 引用比较      | Object 默认引用比较                 |

## `==` 运算符

- **比较的是两个变量的引用（地址）是否相同。**
- 对于基本数据类型，`==`比较的是**值是否相等**
- 对于对象类型，`==`比较的是**内存地址**是否相同。

```text
- 对 基本类型 → 栈上存的是实际值 → == 比较值
- 对 对象类型 → 栈上存的是引用 → == 比较引用（地址）
也就是说，== 永远比较变量本身存储的内容：
基本类型 → 变量存的是数据 → 比较值
引用类型 → 变量存的是引用 → 比较引用
```

## `equals()`方法

- `Object`类的方法，默认实现也是**地址比较**，和`==`相同。
- 许多类（String、Integer、List）重写了`equals()`方法，用来比较**对象的内容**。
- 所以`equals()`比较的是对象的**语义相等性**，而不是地址。

## 特殊情况

| 类型                                | 缓存范围或方式       | 影响 ==               |
|-----------------------------------|---------------|---------------------|
| String                            | 字符串常量池        | 常量池对象引用相同 → == true |
| Integer/Long/Short/Byte/Character | -128~127      | 同上                  |
| Boolean                           | TRUE/FALSE 单例 | == true             |
| Float/Double                      | 无缓存           | == false            |

### 1. 字符串常量池

Java 为了节省内存，对字符串字面量进行了优化。

字符串常量池是 JVM 内部维护的一块特殊内存，存放所有字面量。

对相同字面量的字符串，JVM 只会创建一个对象，其他引用直接指向同一个对象。

只有 `String = "abc"` 才会进入常量池，`new String("abc")` 会直接在堆上创建一个新对象。

`new String("abc").intern()` 会将堆上的字符串加入常量池，如果已存在相同内容则返回常量池对象引用。

### 2. 基本类型包装类缓存

`Integer、Long、Short、Byte、Character`

Java 对**部分范围**的基本类型包装类做了缓存，以减少频繁创建对象。

缓存机制让小范围**包装类**数值变量引用相同对象。

| 类型          | 缓存范围       | 默认缓存行为      |
|-------------|------------|-------------|
| `Byte`      | -128 ~ 127 | 全部缓存        |
| `Short`     | -128 ~ 127 | 缓存          |
| `Integer`   | -128 ~ 127 | 缓存          |
| `Long`      | -128 ~ 127 | 缓存          |
| `Character` | 0 ~ 127    | 缓存 ASCII 范围 |

Boolean.TRUE 和 Boolean.FALSE 是**单例**。
所有 `Boolean` 对象通过 `Boolean.valueOf(true/false)` 获取，引用相同。

`Float` 和 `Double` **默认不缓存**，所以` == `对包装对象通常比较的是引用。